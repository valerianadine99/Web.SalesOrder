(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{9182:function(e,s,t){Promise.resolve().then(t.bind(t,3520))},3520:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var a=t(7437),r=t(2265),n=t(4033),l=t(733),i=t(5635),c=t(8823),d=t(2482),x=t(2549),m=t(1827),o=()=>{let{fetchOrders:e}=(0,i.L)(),[s,t]=(0,r.useState)({customerFilter:"",startDate:"",endDate:""}),n=(e,s)=>{t(t=>({...t,[e]:s}))},l=Object.values(s).some(e=>""!==e);return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-secondary-200 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-secondary-900 flex items-center",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Filtros de B\xfasqueda"]}),l&&(0,a.jsxs)(c.zx,{variant:"ghost",size:"sm",onClick:()=>{let s={customerFilter:"",startDate:"",endDate:""};t(s),e(s)},className:"text-secondary-600 hover:text-secondary-800",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-1"}),"Limpiar"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(c.II,{label:"Cliente",placeholder:"Nombre del cliente",value:s.customerFilter,onChange:e=>n("customerFilter",e.target.value)}),(0,a.jsx)(c.II,{label:"Fecha Inicio",type:"date",value:s.startDate,onChange:e=>n("startDate",e.target.value)}),(0,a.jsx)(c.II,{label:"Fecha Fin",type:"date",value:s.endDate,onChange:e=>n("endDate",e.target.value)})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsxs)(c.zx,{onClick:()=>{e(s)},className:"px-6",disabled:!l,children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Buscar"]})}),l&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-secondary-200",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[s.customerFilter&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:["Cliente: ",s.customerFilter]}),s.startDate&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary-100 text-secondary-800",children:["Desde: ",new Date(s.startDate).toLocaleDateString()]}),s.endDate&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-secondary-100 text-secondary-800",children:["Hasta: ",new Date(s.endDate).toLocaleDateString()]})]})})]})},h=t(4322),p=t(7972),u=t(8203),y=t(9670),j=t(9617),N=t(1138),f=t(4307),w=t(6445),v=e=>{let{onEdit:s,onView:t,onDelete:r,isDeleting:n}=e,{orders:l,pagination:d,isLoading:x}=(0,i.L)(),m=e=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(e),o=e=>(0,f.Z)(new Date(e),"dd/MM/yyyy",{locale:w.Z}),v=e=>e.orderDetails.reduce((e,s)=>e+s.quantity*s.unitPrice,0);return x?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):0===l.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(h.Z,{className:"mx-auto h-12 w-12 text-secondary-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-secondary-900",children:"No hay \xf3rdenes"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-secondary-500",children:"No se encontraron \xf3rdenes con los filtros aplicados."})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-secondary-200",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-secondary-200",children:[(0,a.jsx)("thead",{className:"bg-secondary-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Orden"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Cliente"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Fecha"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Total"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Productos"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Creado por"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-secondary-500 uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-secondary-200",children:l.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-secondary-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-secondary-900",children:["#",e.id]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 text-secondary-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-secondary-900",children:e.customerName}),(0,a.jsx)("div",{className:"text-sm text-secondary-500",children:e.customerEmail})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 text-secondary-400"}),(0,a.jsx)("span",{className:"text-sm text-secondary-900",children:o(e.orderDate)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-secondary-900",children:m(v(e))}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 text-secondary-400"}),(0,a.jsxs)("span",{className:"text-sm text-secondary-900",children:[e.orderDetails.length," producto",1!==e.orderDetails.length?"s":""]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-secondary-500",children:e.createdBy}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(c.zx,{variant:"ghost",size:"sm",onClick:()=>t(e),className:"text-primary-600 hover:text-primary-800",title:"Ver detalles",children:(0,a.jsx)(y.Z,{className:"w-4 h-4"})}),(0,a.jsx)(c.zx,{variant:"ghost",size:"sm",onClick:()=>s(e),className:"text-secondary-600 hover:text-secondary-800",title:"Editar orden",children:(0,a.jsx)(j.Z,{className:"w-4 h-4"})}),(0,a.jsx)(c.zx,{variant:"ghost",size:"sm",onClick:()=>r(e),className:"text-danger-600 hover:text-danger-800",title:"Eliminar orden",disabled:n===e.id,children:n===e.id?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-danger-600"}):(0,a.jsx)(N.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})}),d.totalCount>0&&(0,a.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-secondary-200 sm:px-6",children:[(0,a.jsxs)("div",{className:"text-sm text-secondary-700",children:["Mostrando"," ",(0,a.jsx)("span",{className:"font-medium",children:(d.pageNumber-1)*d.pageSize+1})," ","a"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(d.pageNumber*d.pageSize,d.totalCount)})," ","de"," ",(0,a.jsx)("span",{className:"font-medium",children:d.totalCount})," ","resultados"]}),(0,a.jsxs)("div",{className:"text-sm text-secondary-500",children:["P\xe1gina ",d.pageNumber," de ",d.totalPages]})]})]})},g=t(5883),b=t(9883),D=t(5925);function C(){let{user:e,logout:s,isAuthenticated:t}=(0,l.t)(),{fetchOrders:d,deleteOrder:x}=(0,i.L)(),m=(0,n.useRouter)(),[u,y]=(0,r.useState)(null),[j,N]=(0,r.useState)(!1),[f,w]=(0,r.useState)(!1),[C,k]=(0,r.useState)(!1),[Z,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!t){m.push("/");return}d()},[t,m,d]);let z=async()=>{try{await s(),m.push("/"),(0,D.default)("Sesi\xf3n cerrada exitosamente",{icon:"✅"})}catch(e){(0,D.default)("Error al cerrar sesi\xf3n",{icon:"❌"})}},E=async e=>{if(confirm("\xbfEst\xe1s seguro de que quieres eliminar la orden #".concat(e.id,"?"))){y(e.id);try{await x(e.id),(0,D.default)("Orden eliminada exitosamente",{icon:"✅"})}catch(e){(0,D.default)("Error al eliminar la orden",{icon:"❌"})}finally{y(null)}}};return t?(0,a.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-secondary-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"h-8 w-8 text-primary-600 mr-3"}),(0,a.jsx)("h1",{className:"text-xl font-semibold text-secondary-900",children:"Sistema de Gesti\xf3n Log\xedstica"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-secondary-700",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),(null==e?void 0:e.name)||(null==e?void 0:e.email)]}),(0,a.jsxs)(c.zx,{variant:"outline",size:"sm",onClick:z,className:"text-secondary-600 hover:text-secondary-800",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Cerrar Sesi\xf3n"]})]})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-secondary-900",children:"Gesti\xf3n de \xd3rdenes"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-secondary-600",children:"Administra y monitorea todas las \xf3rdenes de venta del sistema"})]}),(0,a.jsxs)(c.zx,{onClick:()=>{N(!0)},className:"bg-primary-600 hover:bg-primary-700",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 mr-2"}),"Nueva Orden"]})]})}),(0,a.jsx)(o,{}),(0,a.jsx)(v,{onEdit:e=>{S(e),w(!0)},onView:e=>{S(e),k(!0)},onDelete:E,isDeleting:u})]}),(0,a.jsx)(c.y,{isOpen:j,onClose:()=>{N(!1)}}),(0,a.jsx)(c.mx,{isOpen:f,order:Z,onClose:()=>{w(!1),S(null)}}),(0,a.jsx)(c.ZU,{isOpen:C,order:Z,onClose:()=>{k(!1),S(null)}}),(0,a.jsx)("div",{id:"toast-container"})]}):null}}},function(e){e.O(0,[36,365,852,971,938,744],function(){return e(e.s=9182)}),_N_E=e.O()}]);